name: Build and Deploy Hexo
on:
  push:
    branches:
      - hexo
jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout 🛎️
      uses: actions/checkout@master
      
    - name: Use Node.js 12
      uses: actions/setup-node@v2-beta
      with:
        node-version: '12'

    - name: Install Pandoc
      run: |
        sudo apt-get install pandoc
    - name: set github profile
      run: |
        git config --global user.name 'wqkenqing'
        git config --global user.email 'wqkenqingto@126.com'
    - name: Setup SSH Key
      run: |
       mkdir -p ~/.ssh
       echo "${{ secrets.SSH_DEPLOY_KEY }}" > ~/.ssh/id_ed25519
       chmod 600 ~/.ssh/id_ed25519
    - name: Install and Build 🔧 
      run: |
        rm -rf node_modules && npm install --force
        npm install --save hexo-renderer-less hexo-renderer-ejs
        npm install -g hexo-cli
        npm i hexo-theme-async@latest
        npm install hexo-deployer-git --save
        hexo clean
        hexo generate
        hexo deploy


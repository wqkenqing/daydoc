

发版步骤

 

1. 完成测试项，评估能否发版
2. 暂停代码提交
3. 数据库备份
4. 打包镜像发到远程
5. 同步数据库变更信息
6. 发版
7. 回归测试
8. 验证通过

 

 

| 更新项目            | 更新版本号 |      |      |
| ------------------- | ---------- | ---- | ---- |
| sxsddsj_web         | **11262**  |      |      |
| sxsddsj-main        | **11251**  |      |      |
| sxsddsj-auth-center | **11230**  |      |      |
| sxsddsj-file-server | **11200**  |      |      |
| sxsddsj-file-system | **11137**  |      |      |

 

 

数据库更新文件

sxsddsj_auth_center.sql

sxsddsj_main_railway_project.sql

sxsddsj_main_railway_tunnel.sql



es索引





```
{
  "mapping": {
    "properties": {
      "_class": {
        "type": "text",
        "fields": {
          "keyword": {
            "type": "keyword",
            "ignore_above": 256
          }
        }
      },
      "createTime": {
        "type": "date",
        "format": "yyyy-MM-dd HH:mm:ss"
      },
      "describe": {
        "type": "text",
        "analyzer": "ik_max_word"
      },
      "filePath": {
        "type": "keyword"
      },
      "fileSize": {
        "type": "long"
      },
      "format": {
        "type": "keyword"
      },
      "id": {
        "type": "long"
      },
      "isFile": {
        "type": "boolean"
      },
      "itemId": {
        "type": "long"
      },
      "name": {
        "type": "text",
        "fields": {
          "keyword": {
            "type": "keyword"
          }
        },
        "analyzer": "ik_max_word"
      },
      "outTags": {
        "type": "keyword"
      },
      "parentId": {
        "type": "long"
      },
      "updateTime": {
        "type": "date",
        "format": "yyyy-MM-dd HH:mm:ss"
      }
    }
  }
}
```

  sxsddsj-file-system-railway 





```
curl -u elastic:7FKBKZrTTTPG2LnC  -XPUT "http://localhost:9200/sxsddsj-file-system-railway" -H 'Content-Type: application/json' -d '
{
  "mappings": {
    "properties": {
      "_class": {
        "type": "text",
        "fields": {
          "keyword": {
            "type": "keyword",
            "ignore_above": 256
          }
        }
      },
      "createTime": {
        "type": "date",
        "format": "yyyy-MM-dd HH:mm:ss"
      },
      "describe": {
        "type": "text",
        "analyzer": "ik_max_word"
      },
      "filePath": {
        "type": "keyword"
      },
      "fileSize": {
        "type": "long"
      },
      "format": {
        "type": "keyword"
      },
      "id": {
        "type": "long"
      },
      "isFile": {
        "type": "boolean"
      },
      "itemId": {
        "type": "long"
      },
      "name": {
        "type": "text",
        "fields": {
          "keyword": {
            "type": "keyword"
          }
        },
        "analyzer": "ik_max_word"
      },
      "outTags": {
        "type": "keyword"
      },
      "parentId": {
        "type": "long"
      },
      "updateTime": {
        "type": "date",
        "format": "yyyy-MM-dd HH:mm:ss"
      }
    }
  }
}'

```







bin/elasticsearch-plugin install https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.1.0/elasticsearch-analysis-ik-v7.1.0.zip





```
curl -u elastic:7FKBKZrTTTPG2LnC -XGET http://namenode:9200/sxsddsj-file-system-railway/_mapping

```

```
curl -XGET http://es01:9200/sxsddsj-file-system-railway/_mapping

```



```
curl -u elastic:7FKBKZrTTTPG2LnC -XGET http://namenode:9200/sxsddsj-file-system/_mapping

```





```
curl -u elastic:7FKBKZrTTTPG2LnC -XDELETE http://namenode:9200/sxsddsj-file-system-railway

```



```
curl  -XPUT "http://datanode2:9200/sxsddsj-file-system-railway" -H 'Content-Type: application/json' -d '
{
  "mappings": {
    "properties": {
      "_class": {
        "type": "text",
        "fields": {
          "keyword": {
            "type": "keyword",
            "ignore_above": 256
          }
        }
      },
      "createTime": {
        "type": "date",
        "format": "yyyy-MM-dd HH:mm:ss"
      },
      "describe": {
        "type": "text",
        "analyzer": "ik_max_word"
      },
      "filePath": {
        "type": "keyword"
      },
      "fileSize": {
        "type": "long"
      },
      "format": {
        "type": "keyword"
      },
      "id": {
        "type": "long"
      },
      "isFile": {
        "type": "boolean"
      },
      "itemId": {
        "type": "long"
      },
      "name": {
        "type": "text",
        "fields": {
          "keyword": {
            "type": "keyword"
          }
        },
        "analyzer": "ik_max_word"
      },
      "outTags": {
        "type": "keyword"
      },
      "parentId": {
        "type": "long"
      },
      "updateTime": {
        "type": "date",
        "format": "yyyy-MM-dd HH:mm:ss"
      }
    }
  }
}'

```

```
curl -u elastic:7FKBKZrTTTPG2LnC -XPOST http://datanode1:9200/_security/user/elastic/_password -H 'Content-Type: application/json' -d '{
  "password" : "7FKBKZrTTTPG2LnC"
}'

```

elastic
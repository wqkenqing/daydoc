title:  数据采集服务
date:  2021年 4月28日
tags: [flume,beats,采集]
password: 7FKBKZrTTTPG2LnC

---
 <!--more-->

 # 数据采集服务

> 针对项目和产品化的构思,数据中心这个载体中的基本组成部件中,数据采集模块是必不可少的,在以往的经历中,数据采集主要是依托于某一两个组件,运行的某些采集服务,比较功能和内容单薄,这次对数据采集服务进行一次升级,封装

可能涉及到的组件和内容

1. flume
2. beats
3. python
4. java

## flume采集
Flume版本:1.9.0

> 因为结合业务来做,原始采集的这个第一环节，尽量封装度高一些。所以这里对数据源，一是关注采集源种类，二是关注采集协议

### Source

demo

```
# example.conf: A single-node Flume configuration

# Name the components on this agent
a1.sources = r1
a1.sinks = k1
a1.channels = c1

# Describe/configure the source
a1.sources.r1.type = netcat
a1.sources.r1.bind = localhost
a1.sources.r1.port = 44444
##这个参数可以设置对接数据的编码格式。
a1.sources.r1.encoding= gbk 

# Describe the sink
a1.sinks.k1.type = logger

# Use a channel which buffers events in memory
a1.channels.c1.type = memory
a1.channels.c1.capacity = 1000
a1.channels.c1.transactionCapacity = 100

# Bind the source and sink to the channel
a1.sources.r1.channels = c1
a1.sinks.k1.channel = c1

```

flume-ng agent --conf conf --conf-file test.conf --name a1 -Dflume.root.logger=INFO,console
flume-ng agent --conf conf --conf-file conf/gbkfile.conf --name a1 -Dflume.root.logger=DEBUG,console
flume-ng agent --conf conf --conf-file conf/gbkkafka.conf --name a1 -Dflume.root.logger=DEBUG,console


Q: tcp协议时,发送中文出现乱码

A:思路,修改flume的conf 编码协议